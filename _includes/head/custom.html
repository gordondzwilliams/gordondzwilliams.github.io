{% include base_path %}

<!-- start custom head snippets -->

<!-- Support for Academicons -->
<link rel="stylesheet" href="{{ base_path }}/assets/css/academicons.css"/>

<!-- favicon from https://commons.wikimedia.org/wiki/File:OOjs_UI_icon_academic-progressive.svg -->
<link rel="apple-touch-icon" sizes="180x180" href="{{ base_path }}/images/apple-touch-icon-180x180.png"/>
<link rel="icon" type="image/svg+xml" href="{{ base_path }}/images/favicon.svg"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-192x192.png" sizes="192x192"/>
<link rel="manifest" href="{{ base_path }}/images/manifest.json"/>
<link rel="icon" href="/images/favicon.ico"/>
<meta name="theme-color" content="#ffffff"/>

<!-- end custom head snippets -->

<!-- Open CV (and only CV) in a new tab by intercepting the click -->
<script>
/* We use event delegation so it works with any theme nav (including greedy-nav)
   and we do it on click so browsers treat it as a user gesture (no popup block). */
document.addEventListener('click', function (e) {
  var a = e.target.closest('a');
  if (!a) return;

  // Resolve absolute URL and pathname for robust matching
  try {
    var url = new URL(a.href, window.location.origin);
  } catch (err) {
    return; // not a normal link
  }

  // Match your exact CV PDF (regardless of absolute/relative URL or query string)
  var isCvPdf = url.pathname.endsWith('/files/Williams_Gordon_CV.pdf');

  if (isCvPdf) {
    e.preventDefault();
    e.stopPropagation(); // ensure theme JS doesn't override

    // Build the CV URL using Jekyll's relative_url (handles baseurl)
    var cvPdf = "{{ '/files/Williams_Gordon_CV.pdf' | relative_url }}";

    // Open in a new tab (user gesture = allowed)
    window.open(cvPdf, '_blank', 'noopener');
    return false;
  }
}, true); // capture phase so we run before other handlers
</script>
